% data from Pula aquarium

% with Plastics
LW_plast = [45	5
56	17.3
26	1.37
22.4	0.95
19.7	1.037
21	1.1755
22.2	1.433
26.5	2.412
]; 
LW_plast = sortrows(LW_plast);


LW_contr = [45.0	11.000
52.0	17.000
53.5	16.500
32.8	4.500
51.0	16.000
45.2	10.000
21.0	1.150
18.0	0.725
54.5	18.900
35.7	5.350
52.0	13.120
20.4	1.125
31.4	3.750
26.3	2.350
23.4	1.800
35.1	4.900
37.7	6.950
19.8	1.070
48	16.7
34.2	4.3
28	2.4
34	4.9
33.5	4
47	20
43.8	10
45	8
58.1	20
65	30
62.4	30
37.1	5.7
39.4	8
43.7	10
49	17
45.5	9
33.7	4.5
25	1.168
37.6	5.6
64	30
53.4	20
27	2.5
53.5	20.6
49.3	16
41.3	10.2
31.5	3
46.5	13.5
26.2	2.5
63	20
59.7	21
54.1	19.6
60.2	26
26.9	2.6
23.1	1.6
48.6	13.5
31.8	3.6
36	7.2
33	5.5
36.8	5.4
38.2	7
42.5	11
52.5	18
59.7	25
43.6	10
30.5	3.8
35.8	7.6
46.9	18
31.2	3.8
43.6	10.3
47	13
32.8	4.2
]; 
LW_contr = sortrows(LW_contr);

% North Atlantic, 'WabnPaul2008'
LW_Wab = [12.18,1 ;12.98,0.67; 13.69,1.12; 14.39,1.01; 15.47,0.83; 16.77,0.84; 17.54,0.66; 18.23,1.91; 19.09,0.31; 19.27,2.62; 19.87,0.67; 20.56,2.27; 21.25,0.49; 22.11,2.45; 22.54,0.85; 23.06,2.81; 23.41,1.03;
    23.92,1.39; 24.09,3.16; 24.61,0.68; 24.78,3.88; 25.13,0.86; 25.47,2.46; 25.91,3.52; 26.16,1.75; 26.77,0.50; 26.94,2.46; 26.94,4.06; 27.72,1.22; 28.58,4.06; 28.84,3 ;29.7,4.24; 30.22,4.6; 30.99,3.18; 31.51,5.85;
    31.94,4.6; 33.58,5.32; 34.53,5.68; 34.96,4.79; 36.08,6.75; 37.97,8.17; 39.61,8.89; 40.3,8; 42.11,12.45; 42.28,10.49; 42.37,5.16; 44.78,11.92; 44.87,14.41; 47.2,14.59; 47.28,9.62; 48.84,16.37; 49.7,16.73; 50.3,19.93;
    52.2,19.4; 54.01,24.56; 54.87,22.79;56.59,24.75; 59.01,25.29; 59.7,28.13; 60.13,18.18; 60.13,19.6; 60.65,30.8; 61.51,32.58; 61.77,33.65; 63.58,34.19; 64.87,36.5; 66.42,39.7; 67.97,46.28; 73.32,54.83; 78.49,65.69; 83.06,78.14;
    84.96,81.52; 41.08,12.62; 42.97,15.3; 43.15,11.92; 43.75,15.3; 44.09,9.96; 45.47,14.41; 45.91,18.86; 46.16,16.9; 46.34,14.06; 47.46,13.71; 47.54,18.33; 47.97,21; 48.41,18.33; 48.92,15.66; 48.92,14.95; 49.61,19.22; 49.78,20.11;
    49.96,20.47; 50.13,21.53; 50.22,22.6; 50.56,15.85; 50.56,21.89; 50.82,24.91; 51.16,22.78; 51.51,21.18; 51.51,22.43; 51.59,17.45; 51.77,19.76; 51.77,24.74; 52.37,29.54; 52.37,29.72; 52.46,29.01; 52.54,36.29; 52.72,23.67; 52.8,18.69;
    52.8,22.61; 52.8,28.65; 52.89,26.7; 52.89,27.23; 52.97,22.25; 52.97,26.34; 53.15,25.1; 53.23,34.52; 53.32,22.43; 53.49,24.21; 53.58,22.96; 53.58,23.85; 54.27,20.48; 54.27,16.74; 54.35,19.05; 54.44,21.19; 54.44,18.52; 54.61,27.05;
    54.61,22.25; 54.96,16.57; 55.04,24.57; 55.3,30.79; 55.3,31.86; 55.3,34.34; 55.39,29.9; 55.47,29.37; 55.56,28.48; 55.91,17.1; 55.91,20.66; 55.91,21.9; 55.99,18.7; 55.99,22.79; 56.25,26.35; 56.77,20.66; 56.77,27.24; 56.77,31.86;
    56.85,31.15; 57.03,29.9; 57.11,27.42; 57.11,28.66; 57.54,20.66; 57.89,24.4; 58.32,28.66; 58.32,29.2; 58.41,30.09; 58.41,30.8; 58.41,32.22; 58.58,22.44; 58.66,34.53; 58.66,35.77; 58.75,34.89; 58.75,32.75; 59.09,33.29; 59.35,24.4;
    59.78,35.07; 60.13,27.6; 60.13,35.24; 60.3,24.76; 60.47,35.96; 60.73,36.49; 61.51,27.07; 61.59,26.18; 61.68,25.29; 61.77,38.09; 61.77,38.98; 61.77,40.94; 61.77,41.47; 61.85,37.2; 61.94,29.38; 62.11,39.87; 62.2,37.2; 62.46,29.38;
    62.8,44.14; 62.89,30.98; 62.89,31.87; 62.89,37.03; 62.97,29.21; 62.97,42.01; 63.06,38.27; 63.06,40.41; 63.15,26.36; 63.32,26.36; 63.41,29.03; 63.66,33.3; 63.66,36.85; 63.66,39.16; 63.66,43.25; 64.09,36.5; 64.18,42.54; 64.18,67.25;
    64.27,32.59; 64.53,37.92; 64.53,42.37; 64.7,35.97; 64.7,42.37; 64.78,28.32; 64.96,28.32; 64.96,42.37; 65.04,43.97; 65.04,44.32; 65.04,44.5; 65.13,37.74; 65.22,37.57; 65.47,27.43; 65.65,33.3; 65.73,27.08; 65.73,33.66; 66.08,44.32;
    66.08,44.32; 66.25,40.06; 66.34,43.26; 66.51,40.06; 66.51,42.55; 66.68,37.39; 66.77,36.68; 66.77,37.93; 66.77,41.66; 66.85,36.15; 66.85,38.28; 66.85,46.28; 66.85,46.64; 66.85,47.53; 66.85,48.77; 66.85,50.01; 66.94,41.48; 67.2,41.66;
    67.72,41.31; 67.97,40.42; 68.23,57.66; 68.41,31; 68.75,48.95; 68.75,50.91; 68.92,37.75; 69.18,46.46; 69.27,33.13; 69.44,41.67; 69.61,51.09; 69.87,48.07; 69.96,36.87; 70.04,44.33; 70.56,52.87; 70.91,24.78; 70.99,38.82; 71.42,34.38;
    71.42,51.27; 71.68,52.87; 71.68,53.94; 71.68,54.83; 71.77,55.18; 71.94,55.54; 72.03,43.98; 72.11,49.67; 72.28,56.6; 72.37,39.18; 72.46,46.29; 72.46,52.69; 72.63,46.12; 72.72,53.05; 72.8,57.49; 72.89,46.3; 72.89,48.25; 73.06,47.54;
    73.06,47.54; 73.15,50.92; 73.41,39.36; 73.58,44.87; 74.01,55.72; 74.09,54.48; 74.09,53.41; 74.27,44.7; 74.7,56.79; 74.87,56.79; 75.22,61.77; 75.3,56.79; 75.3,63.9; 75.65,51.81; 75.73,51.81; 75.82,56.97; 75.99,44.35; 76.16,54.48;
    76.16,64.08; 76.34,52.7; 76.34,54.12; 76.42,53.06; 76.42,53.59; 76.42,60.53; 76.77,24.79; 76.77,64.26; 76.85,44.35; 76.94,61.59; 77.2,55.73; 77.28,68.35; 77.37,53.95; 77.54,66.39; 78.06,83.28; 78.23,43.46; 78.23,82.4; 78.41,72.44;
    78.84,61.06; 79.01,70.31; 79.44,76; 79.53,88.44; 79.7,61.24; 79.78,88.44; 80.04,43.47; 80.3,70.31; 80.56,63.91; 80.56,66.22; 80.99,75.65; 81.16,46.67; 82.2,80.98; 82.28,73.34; 82.37,84.36; 82.63,78.85; 82.97,50.58; 83.06,80.63;
    83.92,76.72; 84.35,85.25; 84.35,84.19; 84.7,83.3; 84.96,90.94; 85.04,73.7; 85.65,68.01; 86.08,82.24; 86.59,98.06; 86.94,84.19; 86.94,87.39; 87.72,100.19; 87.8,91.66; 88.15,87.22; 89.09,79.93; 89.18,81.53; 89.78,86.87; 89.96,72.64;
    90.13,72.82; 90.91,103.05; 91.16,82.07; 91.25,90.6; 91.51,85.27; 91.77,95.94; 91.77,104.83; 92.28,99.67; 93.23,108.38; 93.66,100.56; 94.53,98.08; 94.87,125.63; 95.04,114.79; 96.59,104.84; 97.03,121.55; 97.46,117.64; 98.23,101.11;
    99.01,130.62; 100.04,133.29; 101.08,131.16; 102.03,153.74; 103.58,143.96; 105.04,141.12; 70.73,44.87; 78.66,65.51; 82.72,70.32; 87.63,105.53; 96.42,111.41];
LW_Wab = sortrows(LW_Wab);


% BCIs

BCI_plast = LW_plast(:,2) *1000 *100  ./ LW_plast(:,1).^3 ; % 
BCI_contr = LW_contr(:,2) *1000 *100  ./ LW_contr(:,1).^3; 

[h, p] = ttest2(BCI_plast, BCI_contr, 'Tail', 'left') % 1 means hypothesis rejected at default (5%) level

BCI_Wab = LW_Wab(:,2) *1000 *100  ./ LW_Wab(:,1).^3 ; % 


figure(1)
hold on
plot(LW_Wab(:,1), LW_Wab(:,2), 'r.')
plot(LW_plast(:,1),LW_plast(:,2), 'bo', 'MarkerFaceColor', 'b')
plot(LW_contr(:,1),LW_contr(:,2), 'ko')
title('wet weight vs SCL')

figure(2)
hold on
plot(LW_plast(:,1), BCI_plast, 'Color', 'b', 'LineWidth', 1.5)
plot(LW_contr(:,1), BCI_contr, 'Color', 'k', 'LineWidth', 1.5)
plot(LW_Wab(:,1), BCI_Wab, 'Color', 'r', 'LineWidth', 0.8)
title('cond index vs straight length')


%%  CFTOOL za wet weight vs length
% -------------- plastics:  -------------- 
% General model:
%      f(x) = a * x^b
% Coefficients (with 95% confidence bounds):
%        a =   3.289e-07  (-2.324e-06, 2.982e-06)
%        b =       4.411  (2.392, 6.429)
% 
% Goodness of fit:
%   SSE: 9.476
%   R-square: 0.9569
%   Adjusted R-square: 0.9497
%   RMSE: 1.257
% 

% --------------  control:  -------------- 
% General model:
%      f(x) = a * x^b
% Coefficients (with 95% confidence bounds):
%        a =   0.0004884  (7.813e-05, 0.0008987)
%        b =       2.641  (2.431, 2.852)
% 
% Goodness of fit:
%   SSE: 263.8
%   R-square: 0.9384
%   Adjusted R-square: 0.9375
%   RMSE: 1.984

return
figure(1)
set(gcf,'PaperPositionMode','manual');
set(gcf,'PaperUnits','centimeters');
print -dpng  fig_PulaSCL-Ww_all.png

print -dpng  fig_dabest_Pula_Pula.png


% for dabest
% to select BCI of NA larger than smallest in Pula control
ind_larger = find(LW_Wab(:,1) > min(LW_contr(:,1)));
BCI_NAselect = BCI_Wab(ind_larger);
% but remove those too big
ind_tooBig = find(LW_Wab(:,1) > max(LW_contr(:,1)));



% ## How to cite
% **Moving beyond P values: Everyday data analysis with estimation plots**
% *Joses Ho, Tayfun Tumkaya, Sameer Aryal, Hyungwon Choi, Adam Claridge-Chang*
% Nature Methods 2019, 1548-7105. [10.1038/s41592-019-0470-3](http://dx.doi.org/10.1038/s41592-019-0470-3)
% [Paywalled publisher site](https://www.nature.com/articles/s41592-019-0470-3); [Free-to-view PDF](https://rdcu.be/bHhJ4)
