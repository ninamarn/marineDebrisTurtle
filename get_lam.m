function varargout = get_lam(Amat)% ===== ★ ★ ★ ★ ★ =====% get_lam.m% ©2020 Marko Jusup% <mjusup[at]gmail.com>% Inspired by H. Ijima% ===== ★ ★ ★ ★ ★ =====% calculates the population growth rate% ...% also calculates the elasticities of the projection matrix% this is implemented for illustrative purposes[Rmat, dmat] = eig(Amat);                                    % calculate right eigenvectors and eigenvaluesdvec = diag(dmat);                                                 % turn diagnoal matrix of eigenvalues into vectorimax = find(dvec==max(dvec));                            % where is the max eigenvalue?lamdet = dvec(imax);                                             % calculate deterministic population growth rate% population growth rate equals the% largest eigenvalue of the projection matrixRvec = Rmat(:, imax);                                            % take right eigenvector corresponding to max eigenvalueLmat = conj(inv(Rmat));                                         % invert the matrix of right eigenvectors and conjugate...Lvec = real(Lmat(imax, :));                                    % take the real part of row vector corresp. to max eigenvalueSAmat = (Rvec * Lvec)';                                         % sensitivity of projection matrixEAmat = SAmat .* Amat / lamdet;                          % elasticity of projection matrixvarargout{1}=lamdet;varargout{2}=sparse(EAmat);